<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>é¢„ç®—å¤§çˆ†ç‚¸ - æŠ½å¡ç³»ç»Ÿï¼ˆå«è¯´æ˜ï¼‰</title>
  <style>
    body {
      font-family: 'Microsoft YaHei', sans-serif;
      margin: 40px;
      background-color: #eef5ff;
    }
    button {
      font-size: 18px;
      padding: 10px 20px;
      margin-right: 10px;
    }
    .result {
      font-size: 16px;
      margin: 10px 0;
      padding: 10px;
      background-color: #ffffff;
      border-left: 5px solid #3399ff;
      border-radius: 5px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .highlight {
      color: #ff5500;
    }
  </style>
</head>
<body>

  <button id="btn">ğŸ° ç‚¹å‡»æŠ½å¡</button>
  <button id="exportBtn" disabled>ğŸ“„ å¯¼å‡ºç»“æœ TXT</button>

  <div id="results"></div>

<script>
const data = {
  é¡¹ç›®åç§°: ["æ ¡å›­å¿«é€’ç®¡ç†", "åœ¨çº¿è€ƒè¯•ç›‘æ§", "æ ¡å›­äºŒæ‰‹äº¤æ˜“", "æ ¡å›­å…±äº«å•è½¦", "æ ¡å›­æ´»åŠ¨é¢„çº¦", "æ™ºæ…§è¯¾å ‚äº’åŠ¨", "æ ¡å›­é£Ÿå ‚è®¢é¤"],
  éœ€æ±‚å¡ç‰‡: ["å®åè®¤è¯(6K)", "åœ°å›¾è¿½è¸ª(8K)", "æ”¯ä»˜é›†æˆ(5K)", "äººè„¸è¯†åˆ«(10K)", "æ¨èç®—æ³•(7K)", "å¤šå¹³å°é€‚é…(6K)", "ç§¯åˆ†ç³»ç»Ÿ(4K)", "ç¤¾äº¤åˆ†äº«(3K)", "å¤§æ•°æ®åˆ†æ(10K)", "å®‰å…¨é˜²æŠ¤(8K)"],

  æ¯”ä¾‹å› å­SF: {
    "PREC": "é¡¹ç›®å…ˆä¾‹æ€§ï¼ˆæ˜¯å¦æ˜¯é‡å¤å¼€å‘ç±»ä¼¼é¡¹ç›®ï¼‰",
    "FLEX": "å¼€å‘çµæ´»æ€§ï¼ˆå¯¹å¼€å‘è¿‡ç¨‹çš„é™åˆ¶ç¨‹åº¦ï¼‰",
    "RESL": "é£é™©è§£å†³ç¨‹åº¦ï¼ˆå‰æœŸé£é™©åˆ†æä¸æ¶æ„è®¾è®¡å……åˆ†æ€§ï¼‰",
    "TEAM": "å›¢é˜Ÿå‡èšåŠ›ï¼ˆé¡¹ç›®å›¢é˜Ÿåä½œä¸æ²Ÿé€šç¨‹åº¦ï¼‰",
    "PMAT": "è¿‡ç¨‹æˆç†Ÿåº¦ï¼ˆå¼€å‘è¿‡ç¨‹çš„æ ‡å‡†åŒ–ã€è§„èŒƒåŒ–ç¨‹åº¦ï¼‰"
  },
  SFç­‰çº§å€¼: {
    "æä½": 6.20, "å¾ˆä½": 4.96, "ä½": 3.72,
    "æ ‡ç§°": 2.48, "é«˜": 1.24, "å¾ˆé«˜": 0.00, "æé«˜": -1.24
  },

  å·¥ä½œé‡ä¹˜æ•°EM: {
    "RELY": "å¯¹å¯é æ€§çš„è¦æ±‚",
    "DATA": "æ•°æ®åº“å’Œæ•°æ®é‡å¤æ‚æ€§",
    "CPLX": "è½¯ä»¶åŠŸèƒ½å¤æ‚æ€§",
    "RUSE": "å¯å¤ç”¨ç»„ä»¶éœ€æ±‚",
    "TIME": "æ—¶é—´å“åº”çº¦æŸ",
    "STOR": "å­˜å‚¨ç©ºé—´çº¦æŸ",
    "PVOL": "å¹³å°æ³¢åŠ¨æ€§",
    "ACAP": "åˆ†æå‘˜èƒ½åŠ›",
    "PCAP": "ç¨‹åºå‘˜èƒ½åŠ›",
    "PCON": "äººå‘˜ç¨³å®šæ€§",
    "APEX": "åº”ç”¨é¢†åŸŸç»éªŒ",
    "PLEX": "å¹³å°ç»éªŒ",
    "LTEX": "è¯­è¨€ä¸å·¥å…·ç»éªŒ",
    "TOOL": "è½¯ä»¶å·¥å…·æ”¯æŒç¨‹åº¦",
    "SITE": "å¤šåœ°å¼€å‘åè°ƒéš¾åº¦",
    "SCED": "é¡¹ç›®è¿›åº¦å‹åŠ›",
    "DOCU": "æ–‡æ¡£å®Œæ•´æ€§è¦æ±‚"
  },
  EMç­‰çº§å€¼: {
    "æä½": 1.46, "å¾ˆä½": 1.29, "ä½": 1.15,
    "æ ‡ç§°": 1.00, "é«˜": 0.87, "å¾ˆé«˜": 0.74, "æé«˜": 0.62
  },

  äººå‘˜é…ç½®: {
    "ğŸŒŸğŸŒŸğŸŒŸ(é«˜çº§)": 0.8,
    "ğŸŒŸğŸŒŸâ­(é«˜+ä¸­)": 1.0,
    "ğŸŒŸâ­â­(ä¸­çº§)": 1.2,
    "â­â­â­(åˆçº§)": 1.4
  },

  çªå‘äº‹ä»¶: ["è´Ÿè´£äººç¦»èŒ(+30æœˆ)", "é¡¹ç›®å»¶æœŸ(+50æœˆ)", "å®¢æˆ·å˜æ›´(+40æœˆ)", "æŠ€æœ¯è¿”å·¥(+60æœˆ)", "æ²Ÿé€šé—®é¢˜(+20æœˆ)", "å¼€æºæ”¯æŒ(-30æœˆ)", "é¢å¤–èèµ„(-50æœˆ)", "éª¨å¹²ç—…å‡(+25æœˆ)", "ç¡¬ä»¶æ•…éšœ(+20æœˆ)", "å®¢æˆ·å‡å°‘éœ€æ±‚(-40æœˆ)"]
};

let step = 0;
const steps = ["é¡¹ç›®åç§°", "éœ€æ±‚å¡ç‰‡", "æ¯”ä¾‹å› å­SF", "å·¥ä½œé‡ä¹˜æ•°EM", "äººå‘˜é…ç½®", "çªå‘äº‹ä»¶"];
let resultsText = "";

document.getElementById('btn').onclick = async function(){
  if(step >= steps.length) return;
  const btn = this;
  btn.disabled = true;

  const stepName = steps[step];
  const container = document.createElement('div');
  container.className = "result";
  container.innerHTML = `<b>${stepName}ï¼š</b><span class="highlight">æŠ½å–ä¸­...</span>`;
  document.getElementById('results').appendChild(container);

  await animateDrawWithExplain(container, stepName);

  step++;
  if (step >= steps.length) {
    btn.disabled = true;
    document.getElementById('exportBtn').disabled = false;
  } else {
    btn.disabled = false;
  }
};

document.getElementById('exportBtn').onclick = function(){
  const blob = new Blob([resultsText], {type: "text/plain;charset=utf-8"});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = "é¢„ç®—å¤§çˆ†ç‚¸_æŠ½å¡ç»“æœ.txt";
  a.click();
};

function randomChoice(arr){ return arr[Math.floor(Math.random() * arr.length)]; }
function randomChoices(arr, n){
  let copy = [...arr], res = [];
  for(let i = 0; i < n; i++){
    let idx = Math.floor(Math.random() * copy.length);
    res.push(copy.splice(idx,1)[0]);
  }
  return res;
}

async function animateDrawWithExplain(div, stepName) {
  const delay = ms => new Promise(res => setTimeout(res, ms));

  if(stepName === "é¡¹ç›®åç§°"){
    const options = data["é¡¹ç›®åç§°"];
    let final = randomChoice(options);
    for (let i = 0; i < 15; i++) {
      div.innerHTML = `<b>${stepName}ï¼š</b><span class="highlight">${randomChoice(options)}</span>`;
      await delay(40 + i * 8);
    }
    div.innerHTML = `<b>${stepName}ï¼š</b><span class="highlight">${final}</span>`;
    resultsText += `é¡¹ç›®åç§°ï¼š${final}\n`;
  }

  else if(stepName === "éœ€æ±‚å¡ç‰‡"){
    const options = data["éœ€æ±‚å¡ç‰‡"];
    let final = randomChoices(options, 3);
    for (let i = 0; i < 15; i++) {
      let temp = randomChoices(options, 3);
      div.innerHTML = `<b>${stepName}ï¼š</b><span class="highlight">${temp.join("ï¼Œ")}</span>`;
      await delay(50 + i * 6);
    }
    div.innerHTML = `<b>${stepName}ï¼š</b><span class="highlight">${final.join("ï¼Œ")}</span>`;
    resultsText += `éœ€æ±‚å¡ç‰‡ï¼š${final.join("ï¼Œ")}\n`;
  }

  else if(stepName === "æ¯”ä¾‹å› å­SF"){
    let final = Object.entries(data["æ¯”ä¾‹å› å­SF"]).map(([key, desc]) => {
      let level = randomChoice(Object.keys(data["SFç­‰çº§å€¼"]));
      let val = data["SFç­‰çº§å€¼"][level];
      return `${key}ï¼ˆ${desc}ï¼‰â†’ ${level}ï¼Œ${val}`;
    });
    for (let i = 0; i < 15; i++) {
      let temp = Object.entries(data["æ¯”ä¾‹å› å­SF"]).map(([key, desc]) => {
        let level = randomChoice(Object.keys(data["SFç­‰çº§å€¼"]));
        let val = data["SFç­‰çº§å€¼"][level];
        return `<span class="highlight">${key}ï¼ˆ${desc}ï¼‰â†’ ${level}ï¼Œ${val}</span>`;
      });
      div.innerHTML = `<b>${stepName}ï¼š</b><br>` + temp.join("<br>");
      await delay(50 + i * 6);
    }
    div.innerHTML = `<b>${stepName}ï¼š</b><br>` + final.join("<br>");
    resultsText += `æ¯”ä¾‹å› å­SFï¼š\n${final.join("\n")}\n`;
  }

  else if(stepName === "å·¥ä½œé‡ä¹˜æ•°EM"){
    const all = Object.entries(data["å·¥ä½œé‡ä¹˜æ•°EM"]);
    const selected = randomChoices(all, 4);
    let final = selected.map(([key, desc]) => {
      let level = randomChoice(Object.keys(data["EMç­‰çº§å€¼"]));
      let val = data["EMç­‰çº§å€¼"][level];
      return `${key}ï¼ˆ${desc}ï¼‰â†’ ${level}ï¼ŒÃ—${val}`;
    });
    for (let i = 0; i < 15; i++) {
      let temp = randomChoices(all, 4).map(([key, desc]) => {
        let level = randomChoice(Object.keys(data["EMç­‰çº§å€¼"]));
        let val = data["EMç­‰çº§å€¼"][level];
        return `<span class="highlight">${key}ï¼ˆ${desc}ï¼‰â†’ ${level}ï¼ŒÃ—${val}</span>`;
      });
      div.innerHTML = `<b>${stepName}ï¼š</b><br>` + temp.join("<br>");
      await delay(50 + i * 6);
    }
    div.innerHTML = `<b>${stepName}ï¼š</b><br>` + final.join("<br>");
    resultsText += `å·¥ä½œé‡ä¹˜æ•°EMï¼š\n${final.join("\n")}\n`;
  }

  else if(stepName === "äººå‘˜é…ç½®"){
    let entries = Object.entries(data["äººå‘˜é…ç½®"]);
    let [finalName, finalVal] = randomChoice(entries);
    for (let i = 0; i < 15; i++) {
      let [n, v] = randomChoice(entries);
      div.innerHTML = `<b>${stepName}ï¼š</b><span class="highlight">${n}ï¼ˆÃ—${v}ï¼‰</span>`;
      await delay(40 + i * 6);
    }
    div.innerHTML = `<b>${stepName}ï¼š</b><span class="highlight">${finalName}ï¼ˆÃ—${finalVal}ï¼‰</span>`;
    resultsText += `äººå‘˜é…ç½®ï¼š${finalName}ï¼ˆÃ—${finalVal}ï¼‰\n`;
  }

  else if(stepName === "çªå‘äº‹ä»¶"){
    const options = data["çªå‘äº‹ä»¶"];
    let final = randomChoices(options, 2);
    for (let i = 0; i < 15; i++) {
      let temp = randomChoices(options, 2);
      div.innerHTML = `<b>${stepName}ï¼š</b><span class="highlight">${temp.join("ï¼Œ")}</span>`;
      await delay(50 + i * 6);
    }
    div.innerHTML = `<b>${stepName}ï¼š</b><span class="highlight">${final.join("ï¼Œ")}</span>`;
    resultsText += `çªå‘äº‹ä»¶ï¼š${final.join("ï¼Œ")}\n`;
  }
}
</script>
</body>
</html>
